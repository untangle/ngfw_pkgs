# Copyright (c) 2022 Arista Networks, Inc.  All rights reserved.
# Arista Networks, Inc. Confidential and Proprietary.

images:
  # we don't reuse mfw/build%build-floor to avoid a circular dependency
  build-floor:
    units:
    - image: barney.ci/debian%minbase
    - image: barney.ci/debian%network
    entry:
      mutables:
        - /root
    finalizers:
    - - apt
      - install
      - -y
      - yarnpkg

  test/build-floor:
    description: |
      Check that we can run a couple of utilities
    units:
    - floor: .%build-floor
      build: |
        yarnpkg --version

  build:
    units:
    - floor: .%build-floor
      build: |
        yarnpkg install
        yarnpkg build

  test/lint:
    units:
      - floor: .%build-floor
        build: |
          yarnpkg install
          yarnpkg build
          yarnpkg lint

