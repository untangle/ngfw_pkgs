import {
  allOperatorOptions,
  connectionStateOptions,
  limitRateOperatorOptions,
  limitBurstOperatorOptions,
  protocolOptions,
  riskLevelOptions,
  productivityLevelOptions,
  countryOptions,
  onlyIsOperatorOptions,
  addressTypeOptions,
  interfaceTypeOptions,
} from '../../../constants'

export const conditionDefs = {
  APPLICATION_NAME: { field: 'autocomplete', ops: onlyIsOperatorOptions, layer3: false },
  APPLICATION_CATEGORY: { field: 'autocomplete', ops: onlyIsOperatorOptions, layer3: false },
  APPLICATION_PRODUCTIVITY: {
    field: 'select',
    ops: allOperatorOptions,
    selectItems: productivityLevelOptions,
    layer3: false,
  },
  APPLICATION_RISK: { field: 'select', ops: allOperatorOptions, selectItems: riskLevelOptions, layer3: false },
  APPLICATION_CONFIDENCE: { ops: allOperatorOptions, layer3: false },
  APPLICATION_PROTOCHAIN: {},

  CLIENT_ADDRESS: { extraRules: 'ip_expression', layer3: true },
  CLIENT_ADDRESS_V6: { extraRules: 'ip_v6_expression', layer3: true },
  CLIENT_PORT: { ops: allOperatorOptions, extraRules: 'port', layer3: true },
  CLIENT_INTERFACE_TYPE: { field: 'select', selectItems: interfaceTypeOptions, layer3: true },
  CLIENT_INTERFACE_ZONE: { field: 'select', layer3: true },

  SERVER_ADDRESS: { extraRules: 'ip_expression', layer3: true },
  SERVER_ADDRESS_V6: { extraRules: 'ip_v6_expression', layer3: true },
  SERVER_PORT: { ops: allOperatorOptions, extraRules: 'port', layer3: true },
  SERVER_DNS_HINT: { layer3: true },
  SERVER_INTERFACE_TYPE: { field: 'select', selectItems: interfaceTypeOptions, layer3: true },
  SERVER_INTERFACE_ZONE: { field: 'select', layer3: true },

  SOURCE_ADDRESS: { extraRules: 'ip_expression', layer3: true },
  SOURCE_ADDRESS_V6: { extraRules: 'ip_v6_expression', layer3: true },
  SOURCE_ADDRESS_TYPE: { field: 'select', selectItems: addressTypeOptions, layer3: true },
  SOURCE_PORT: {
    defaults: { op: '==', value: '', port_protocol: undefined },
    extraRules: 'port_expression',
    layer3: true,
  },
  SOURCE_INTERFACE_NAME: {},
  SOURCE_INTERFACE_TYPE: { field: 'select', selectItems: interfaceTypeOptions, layer3: true },
  SOURCE_INTERFACE_ZONE: { field: 'select', layer3: true },

  DESTINATION_ADDRESS: { extraRules: 'ip_expression', layer3: true },
  DESTINATION_ADDRESS_V6: { extraRules: 'ip_v6_expression', layer3: true },
  DESTINATION_ADDRESS_TYPE: { field: 'select', selectItems: addressTypeOptions, layer3: true },
  DESTINATION_PORT: {
    defaults: { op: '==', value: '', port_protocol: undefined },
    extraRules: 'port_expression',
    layer3: true,
  },
  DESTINATION_INTERFACE_NAME: {},
  DESTINATION_INTERFACE_TYPE: { field: 'select', selectItems: interfaceTypeOptions, layer3: true },
  DESTINATION_INTERFACE_ZONE: { field: 'select', layer3: true },

  DESTINED_LOCAL: { field: 'boolean', defaults: { op: '==', value: true }, layer3: true },
  IP_PROTOCOL: { field: 'autocomplete', multiple: true, autocompleteItems: protocolOptions, layer3: true },
  LIMIT_RATE: {
    ops: limitRateOperatorOptions,
    defaults: { op: '<', value: '', rate_unit: undefined },
    extraRules: 'integer|min_value:1',
    layer3: false,
  },
  BURST_SIZE: {
    ops: limitBurstOperatorOptions,
    defaults: { op: '==', value: '', burst_unit: undefined },
    extraRules: 'integer|min_value:0',
    layer3: false,
  },
  GEOIP: { field: 'autocomplete', autocompleteItems: countryOptions, layer3: false },

  CT_STATE: { field: 'select', selectItems: connectionStateOptions, layer3: false },
}

export const conditionTypes = Object.keys(conditionDefs)
