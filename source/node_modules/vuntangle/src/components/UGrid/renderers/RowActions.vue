<template>
  <div class="d-flex" style="gap: 4px">
    <!-- actions iterator with and without tooltip -->
    <div v-for="(action, index) in params.actions" :key="index">
      <!-- blank placeholder -->
      <div v-if="action.isHidden && typeof action.isHidden === 'function' ? action.isHidden(params) : false"></div>

      <!-- actions with tooltip -->
      <v-tooltip v-else-if="action.tooltip" top transition="none">
        <template #activator="{ on, attrs }">
          <v-btn icon small v-bind="attrs" @click.stop="onClick(action)" v-on="on">
            <v-icon small>{{ action.icon }}</v-icon>
          </v-btn>
        </template>
        <span>{{ action.tooltip }}</span>
      </v-tooltip>
      <!-- actions without tooltip -->
      <v-btn v-else icon small @click.stop="onClick(action)">
        <v-icon small>{{ action.icon }}</v-icon>
      </v-btn>
    </div>
  </div>
</template>

<script>
  import Vue from 'vue'
  import { VTooltip } from 'vuetify/lib'
  import cloneDeep from 'lodash/cloneDeep'

  export default Vue.extend({
    components: { VTooltip },

    methods: {
      /**
       * handler when clicking on a action button
       * passing data, node and data index upon click
       * @param {Object} action - the action defined as { icon: '', tooltip: '', handler: ()}
       */
      onClick(action) {
        action.handler({
          data: cloneDeep(this.params.data),
          node: this.params.node,
          index: this.params.node.id,
        })
      },
    },
  })
</script>
