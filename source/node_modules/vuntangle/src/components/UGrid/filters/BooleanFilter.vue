<template>
  <div style="width: 240px">
    <div v-if="!params.disabled">
      <v-list dense class="pa-0" color="transparent">
        <v-list-item>
          <v-list-item-icon class="mr-2"><v-icon small v-text="`mdi-filter`" /></v-list-item-icon>
          <v-list-item-content><v-list-item-title v-text="$vuntangle.$t('filter')" /></v-list-item-content>
          <v-list-item-action v-show="value !== 'all'" class="my-0 v-application">
            <v-btn x-small elevation="0" color="primary" @click="value = 'all'" v-text="$vuntangle.$t('clear')" />
          </v-list-item-action>
        </v-list-item>
      </v-list>

      <v-radio-group v-model="value" dense row hide-details class="my-0 mx-4">
        <v-radio :value="true" :label="trueKey" :ripple="false" />
        <v-radio :value="false" :label="falseKey" :ripple="false" />
      </v-radio-group>

      <v-divider class="mt-4" />
    </div>
    <column-menu :params="params" />
  </div>
</template>
<script>
  import Vue from 'vue'

  // import vuetify components
  import {
    VList,
    VListItem,
    VListItemIcon,
    VIcon,
    VListItemContent,
    VListItemAction,
    VRadioGroup,
    VRadio,
    VDivider,
  } from 'vuetify/lib'

  import ColumnMenu from '../components/ColumnMenu'

  export default Vue.extend({
    components: {
      ColumnMenu,
      VList,
      VListItem,
      VListItemIcon,
      VIcon,
      VListItemContent,
      VListItemAction,
      VRadioGroup,
      VRadio,
      VDivider,
    },
    data() {
      return {
        value: 'all',
        valueGetter: null,
        trueKey: this.$vuntangle.$t('yes'),
        falseKey: this.$vuntangle.$t('no'),
      }
    },
    watch: {
      value() {
        this.params.filterChangedCallback()
      },
    },
    created() {
      this.valueGetter = this.params.valueGetter

      this.trueKey = this.params.trueKey || this.$vuntangle.$t('yes')
      this.falseKey = this.params.falseKey || this.$vuntangle.$t('no')
    },

    methods: {
      isFilterActive() {
        return this.value !== 'all'
      },

      doesFilterPass(params) {
        return this.valueGetter(params.node) === this.value
      },

      getModel() {
        return { value: this.value }
      },

      setModel(model) {
        this.value = model?.value || 'all'
      },
    },
  })
</script>
