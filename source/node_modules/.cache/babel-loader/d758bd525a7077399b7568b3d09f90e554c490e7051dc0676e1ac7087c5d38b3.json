{"ast":null,"code":"import _regeneratorRuntime from \"/home/shubham/Desktop/ngfw_pkgs/untangle-vue-ui/source/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/shubham/Desktop/ngfw_pkgs/untangle-vue-ui/source/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"/home/shubham/Desktop/ngfw_pkgs/untangle-vue-ui/source/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport { VContainer, VSpacer, VDivider, VSwitch, VSlider, VCard } from 'vuetify/lib';\nimport settingsMixin from '../settingsMixin';\nimport InvalidSettings from '../InvalidSettings/Main.vue';\nimport defaults from './defaults';\nimport schema from './schema';\nimport HostDialog from './components/HostDialog.vue';\nimport LookupDialog from './components/LookupDialog.vue';\nvar actionButtonColumn = {\n  width: 30,\n  resizable: false,\n  sortable: false,\n  suppressMenu: true,\n  cellRenderer: 'ActionButton'\n};\nexport default {\n  components: {\n    VContainer: VContainer,\n    VSpacer: VSpacer,\n    VDivider: VDivider,\n    VSwitch: VSwitch,\n    VSlider: VSlider,\n    VCard: VCard,\n    InvalidSettings: InvalidSettings\n  },\n  mixins: [settingsMixin],\n  defaults: defaults,\n  schema: schema,\n  computed: {\n    // threat values\n    threatLevels: function threatLevels() {\n      return {\n        20: this.$t('high_risk'),\n        40: this.$t('suspicious'),\n        60: this.$t('moderate_risk')\n      };\n    },\n    // threat labels\n    threatLevelLabels: function threatLevelLabels() {\n      var _this = this;\n      return Object.keys(this.threatLevels).map(function (threatLevel) {\n        return _this.threatLevels[threatLevel];\n      });\n    },\n    // threat assessed renderer\n    assessed: function assessed() {\n      var assessed = [];\n      for (var i = 20; i <= this.settingsCopy.sensitivity; i += 20) {\n        assessed.push(this.threatLevels[i]);\n      }\n\n      // separate the list by an 'or'\n      if (assessed.length <= 2) {\n        return assessed.join(\" \".concat(this.$t('or'), \" \"));\n      }\n      var one = assessed[0],\n        two = assessed[1],\n        three = assessed[2];\n      return \"\".concat(one, \", \").concat(two, \" \").concat(this.$t('or'), \" \").concat(three);\n    },\n    columnDefs: function columnDefs() {\n      var _this2 = this;\n      return [{\n        headerName: this.$t('network'),\n        field: 'host',\n        comparator: function comparator(a, b) {\n          return _this2.$vuntangle.util.compareIpAny(a, b);\n        }\n      }, {\n        headerName: this.$t('description'),\n        field: 'description'\n      }, _objectSpread(_objectSpread({}, actionButtonColumn), {}, {\n        cellRendererParams: {\n          icon: 'mdi-pencil',\n          small: true,\n          click: function click(_ref) {\n            var node = _ref.node;\n            return _this2.onEditHost(node.id);\n          }\n        }\n      }), _objectSpread(_objectSpread({}, actionButtonColumn), {}, {\n        cellRendererParams: {\n          icon: 'mdi-delete',\n          small: true,\n          click: function click(_ref2) {\n            var node = _ref2.node;\n            return _this2.settingsCopy.passList.splice(node.id, 1);\n          }\n        }\n      })];\n    }\n  },\n  methods: {\n    onThreatLookup: function onThreatLookup() {\n      var that = this;\n      this.$vuntangle.dialog.show({\n        title: this.$t('threat_lookup'),\n        component: LookupDialog,\n        componentEvents: {\n          lookup: function lookup(ip, resolve) {\n            return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n              return _regeneratorRuntime().wrap(function _callee$(_context) {\n                while (1) switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.next = 2;\n                    return that.$emit('lookup', ip, function (result) {\n                      return resolve(result);\n                    });\n                  case 2:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }, _callee);\n            }))();\n          }\n        },\n        width: 600,\n        buttons: [{\n          name: this.$t('close'),\n          handler: function handler() {\n            this.onClose();\n          }\n        }]\n      });\n    },\n    /**\n     * Add or edits passed host\n     * @param {number} index - the record index being edited, if null record is added\n     */\n    onEditHost: function onEditHost() {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      this.$vuntangle.dialog.show({\n        title: index === null ? this.$t('add_host') : this.$t('edit_host'),\n        component: HostDialog,\n        width: 500,\n        actionLabel: index === null ? this.$t('add') : this.$t('update'),\n        componentProps: {\n          settings: this.settingsCopy,\n          index: index\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["VContainer","VSpacer","VDivider","VSwitch","VSlider","VCard","settingsMixin","InvalidSettings","defaults","schema","HostDialog","LookupDialog","actionButtonColumn","width","resizable","sortable","suppressMenu","cellRenderer","components","mixins","computed","threatLevels","$t","threatLevelLabels","_this","Object","keys","map","threatLevel","assessed","i","settingsCopy","sensitivity","push","length","join","concat","one","two","three","columnDefs","_this2","headerName","field","comparator","a","b","$vuntangle","util","compareIpAny","_objectSpread","cellRendererParams","icon","small","click","_ref","node","onEditHost","id","_ref2","passList","splice","methods","onThreatLookup","that","dialog","show","title","component","componentEvents","lookup","ip","resolve","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","$emit","result","stop","buttons","name","handler","onClose","index","arguments","undefined","actionLabel","componentProps","settings"],"sources":["node_modules/vuntangle/src/shared/SettingsThreatPrevention/Main.vue"],"sourcesContent":["<template>\n  <v-container\n    :fluid=\"classicView ? true : false\"\n    :class=\"`${classicView ? 'pa-4 ' : ''}shared-cmp ${disabled ? 'disabled ' : ''}d-flex flex-column flex-grow-1`\"\n  >\n    <div class=\"d-flex align-center\">\n      <h1 v-if=\"classicView\" class=\"headline\">{{ $t('threat_prevention') }}</h1>\n      <h2 v-else class=\"font-weight-light\">{{ $t('threat_prevention') }}</h2>\n      <v-spacer />\n      <!-- threat lookup button placed besides slot actions -->\n      <u-btn\n        v-if=\"!features.isTemplateView\"\n        :disabled=\"disabled || !settings.enabled\"\n        class=\"mx-2\"\n        @click=\"onThreatLookup\"\n      >\n        {{ $t('threat_lookup') }}\n      </u-btn>\n      <slot name=\"actions\" :new-settings=\"settingsCopy\" :is-dirty=\"isDirty\" :defaults=\"$options.defaults\" />\n    </div>\n\n    <v-divider class=\"my-2\" />\n    <p v-html=\"$t('threat_prevention_description')\" />\n    <u-section v-if=\"!!$slots['extra-fields']\">\n      <slot name=\"extra-fields\" />\n    </u-section>\n    <div class=\"d-flex flex-column flex-grow-1 body-2\">\n      <v-switch\n        v-model=\"settingsCopy.enabled\"\n        class=\"body-2 mb-4\"\n        dense\n        inset\n        hide-details\n        :disabled=\"disabled\"\n        :label=\"$t('toggle_threat_prevention', [settingsCopy.enabled ? $t('enabled') : $t('disabled')])\"\n      />\n      {{ $t('blocked_traffic_assessed_as') }} {{ assessed }}\n\n      <v-slider\n        v-model=\"settingsCopy.sensitivity\"\n        class=\"flex-grow-0 body-2\"\n        min=\"20\"\n        max=\"60\"\n        step=\"20\"\n        color=\"#e51313\"\n        track-color=\"#e2e2e2\"\n        :disabled=\"disabled\"\n        :tick-labels=\"threatLevelLabels\"\n        style=\"width: 50%\"\n      />\n      <v-switch\n        v-model=\"settingsCopy.redirect\"\n        :disabled=\"disabled\"\n        class=\"body-2 mb-4\"\n        dense\n        inset\n        hide-details\n        :label=\"\n          $t('toggle_threat_prevention_redirect', [\n            settingsCopy.redirect ? $t('enabled').toLowerCase() : $t('disabled').toLowerCase(),\n          ])\n        \"\n      />\n      <div class=\"d-flex flex-1 align-center mb-2\">\n        <h2 class=\"font-weight-light\">{{ $t('pass_list') }}</h2>\n        <v-spacer />\n        <u-btn :min-width=\"null\" :disabled=\"disabled\" @click=\"onEditHost(null)\">{{ $t('add') }}</u-btn>\n      </div>\n      <v-card elevation=\"0\" class=\"d-flex flex-grow-1\">\n        <u-grid\n          id=\"threat-prevention-pass-list\"\n          :no-data-message=\"$t('no_data_defined_hostname')\"\n          :row-data=\"settingsCopy.passList\"\n          :column-defs=\"columnDefs\"\n          :enable-refresh=\"false\"\n        />\n      </v-card>\n    </div>\n\n    <invalid-settings\n      v-if=\"invalidSettingsErrors\"\n      service=\"Threat Prevention\"\n      :settings=\"settings\"\n      :schema=\"$options.schema\"\n      :errors.sync=\"invalidSettingsErrors\"\n    />\n  </v-container>\n</template>\n<script>\n  import { VContainer, VSpacer, VDivider, VSwitch, VSlider, VCard } from 'vuetify/lib'\n\n  import settingsMixin from '../settingsMixin'\n  import InvalidSettings from '../InvalidSettings/Main.vue'\n  import defaults from './defaults'\n  import schema from './schema'\n  import HostDialog from './components/HostDialog.vue'\n  import LookupDialog from './components/LookupDialog.vue'\n\n  const actionButtonColumn = {\n    width: 30,\n    resizable: false,\n    sortable: false,\n    suppressMenu: true,\n    cellRenderer: 'ActionButton',\n  }\n\n  export default {\n    components: { VContainer, VSpacer, VDivider, VSwitch, VSlider, VCard, InvalidSettings },\n    mixins: [settingsMixin],\n    defaults,\n    schema,\n\n    computed: {\n      // threat values\n      threatLevels() {\n        return { 20: this.$t('high_risk'), 40: this.$t('suspicious'), 60: this.$t('moderate_risk') }\n      },\n      // threat labels\n      threatLevelLabels() {\n        return Object.keys(this.threatLevels).map(threatLevel => this.threatLevels[threatLevel])\n      },\n      // threat assessed renderer\n      assessed() {\n        const assessed = []\n        for (let i = 20; i <= this.settingsCopy.sensitivity; i += 20) {\n          assessed.push(this.threatLevels[i])\n        }\n\n        // separate the list by an 'or'\n        if (assessed.length <= 2) {\n          return assessed.join(` ${this.$t('or')} `)\n        }\n\n        const [one, two, three] = assessed\n        return `${one}, ${two} ${this.$t('or')} ${three}`\n      },\n      columnDefs() {\n        return [\n          {\n            headerName: this.$t('network'),\n            field: 'host',\n            comparator: (a, b) => this.$vuntangle.util.compareIpAny(a, b),\n          },\n          { headerName: this.$t('description'), field: 'description' },\n          {\n            ...actionButtonColumn,\n            cellRendererParams: {\n              icon: 'mdi-pencil',\n              small: true,\n              click: ({ node }) => this.onEditHost(node.id),\n            },\n          },\n          {\n            ...actionButtonColumn,\n            cellRendererParams: {\n              icon: 'mdi-delete',\n              small: true,\n              click: ({ node }) => this.settingsCopy.passList.splice(node.id, 1),\n            },\n          },\n        ]\n      },\n    },\n\n    methods: {\n      onThreatLookup() {\n        const that = this\n        this.$vuntangle.dialog.show({\n          title: this.$t('threat_lookup'),\n          component: LookupDialog,\n          componentEvents: {\n            async lookup(ip, resolve) {\n              await that.$emit('lookup', ip, result => resolve(result))\n            },\n          },\n          width: 600,\n          buttons: [\n            {\n              name: this.$t('close'),\n              handler() {\n                this.onClose()\n              },\n            },\n          ],\n        })\n      },\n\n      /**\n       * Add or edits passed host\n       * @param {number} index - the record index being edited, if null record is added\n       */\n      onEditHost(index = null) {\n        this.$vuntangle.dialog.show({\n          title: index === null ? this.$t('add_host') : this.$t('edit_host'),\n          component: HostDialog,\n          width: 500,\n          actionLabel: index === null ? this.$t('add') : this.$t('update'),\n          componentProps: {\n            settings: this.settingsCopy,\n            index,\n          },\n        })\n      },\n    },\n  }\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}