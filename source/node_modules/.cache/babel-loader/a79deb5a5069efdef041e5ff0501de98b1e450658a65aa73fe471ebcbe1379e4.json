{"ast":null,"code":"import _createForOfIteratorHelper from \"/home/shubham/Desktop/ngfw_pkgs/untangle-vue-ui/source/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _objectSpread from \"/home/shubham/Desktop/ngfw_pkgs/untangle-vue-ui/source/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport cloneDeep from 'lodash/cloneDeep';\nimport { extend } from 'vee-validate';\nimport defaults from '../../defaults';\nexport default {\n  inject: ['$intf', '$interfaces'],\n  props: {\n    /**\n     * the key under `interface` settings.json where aliases are going to be set\n     * e.g.\n     * `v6Aliases` for IPv6 settings\n     * */\n    aliasKey: {\n      type: String,\n      \"default\": 'v6Aliases'\n    }\n  },\n  data: function data(_ref) {\n    var _intf$v6Aliases;\n    var $intf = _ref.$intf;\n    var intf = $intf();\n    return {\n      adding: false,\n      // boolean telling to show the add fields\n      alias: _objectSpread({}, defaults.v6_alias),\n      // model for new v6 alias\n      list: (_intf$v6Aliases = intf.v6Aliases) !== null && _intf$v6Aliases !== void 0 && _intf$v6Aliases.length ? cloneDeep(intf.v6Aliases) : []\n    };\n  },\n  computed: {\n    intf: function intf(_ref2) {\n      var $intf = _ref2.$intf;\n      return $intf();\n    },\n    interfaces: function interfaces(_ref3) {\n      var $interfaces = _ref3.$interfaces;\n      return $interfaces();\n    }\n  },\n  watch: {\n    adding: function adding(value) {\n      if (!value) {\n        // reset\n        this.alias = _objectSpread({}, defaults.v6_alias);\n      }\n    },\n    list: {\n      deep: true,\n      handler: function handler(newList) {\n        this.$set(this.intf, this.aliasKey, newList);\n      }\n    }\n  },\n  created: function created() {\n    extend('unique_ip_v6_address', this.validateUniqueIpV6Address);\n  },\n  methods: {\n    /**\n     * Make sure the IPv6 address of the alias being added does not conflict with any other\n     * interfaces.\n     *\n     * @param {string} value\n     *\n     * @returns {string|boolean}\n     */\n    validateUniqueIpV6Address: function validateUniqueIpV6Address(value) {\n      // check aliases from other network interfaces\n      var _iterator = _createForOfIteratorHelper(this.interfaces),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _networkInterface$v6A;\n          var networkInterface = _step.value;\n          // ignore current interface, those will be checked from the current editable data\n          if (networkInterface.interfaceId === this.intf.interfaceId) {\n            continue;\n          }\n\n          // check v6 aliases\n          if ((_networkInterface$v6A = networkInterface.v6Aliases) !== null && _networkInterface$v6A !== void 0 && _networkInterface$v6A.length) {\n            var _iterator3 = _createForOfIteratorHelper(networkInterface.v6Aliases),\n              _step3;\n            try {\n              for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n                var v6Alias = _step3.value;\n                if (v6Alias.v6Address === value) {\n                  return this.$t('address_conflicts_with_interface', [networkInterface.name]);\n                }\n              }\n            } catch (err) {\n              _iterator3.e(err);\n            } finally {\n              _iterator3.f();\n            }\n          }\n\n          // check v6 static address\n          if (networkInterface.v6StaticAddress === value) {\n            return this.$t('address_conflicts_with_interface', [networkInterface.name]);\n          }\n        }\n\n        // check v6 addresses that are currently being added/edited on this interface\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      var _iterator2 = _createForOfIteratorHelper(this.list),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var _v6Alias = _step2.value;\n          if (_v6Alias.v6Address === value) {\n            return this.$t('address_conflicts_with_current_interface');\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n      if (this.intf.v6StaticAddress === value) {\n        return this.$t('address_conflicts_with_current_interface');\n      }\n      return true;\n    },\n    onAddAlias: function onAddAlias() {\n      this.list.push(this.alias);\n      this.adding = false;\n    },\n    onRemoveAlias: function onRemoveAlias(index) {\n      this.list.splice(index, 1);\n    }\n  }\n};","map":{"version":3,"names":["cloneDeep","extend","defaults","inject","props","aliasKey","type","String","data","_ref","_intf$v6Aliases","$intf","intf","adding","alias","_objectSpread","v6_alias","list","v6Aliases","length","computed","_ref2","interfaces","_ref3","$interfaces","watch","value","deep","handler","newList","$set","created","validateUniqueIpV6Address","methods","_iterator","_createForOfIteratorHelper","_step","s","n","done","_networkInterface$v6A","networkInterface","interfaceId","_iterator3","_step3","v6Alias","v6Address","$t","name","err","e","f","v6StaticAddress","_iterator2","_step2","onAddAlias","push","onRemoveAlias","index","splice"],"sources":["node_modules/vuntangle/src/shared/SettingsInterface/components/ipv6/Ipv6Aliases.vue"],"sourcesContent":["<template>\n  <div>\n    <p class=\"font-weight-bold mt-6 mb-2\">{{ $t('ipv6_aliases') }}</p>\n    <em v-if=\"!list || !list.length\" class=\"mr-2\">{{ $t('no_aliases') }}</em>\n    <v-chip v-for=\"(item, idx) in list\" :key=\"idx\" class=\"mr-1 mb-1\" small close @click:close=\"onRemoveAlias(idx)\">\n      {{ item.v6Address }}{{ item.v6Prefix || item.v6Prefix === 0 ? `/${item.v6Prefix}` : '' }}\n    </v-chip>\n    <v-chip v-if=\"!adding\" class=\"mb-1\" small color=\"primary\" @click=\"adding = true\">{{ $t('add_alias') }}</v-chip>\n\n    <ValidationObserver v-slot=\"{ passes }\" tag=\"div\">\n      <v-row v-if=\"adding\" no-gutters align=\"center\" class=\"mt-2\">\n        <v-col class=\"grow\">\n          <ValidationProvider v-slot=\"{ errors }\" rules=\"required|ip_v6|unique_ip_v6_address\">\n            <u-text-field\n              v-model=\"alias.v6Address\"\n              :label=\"$t('address')\"\n              class=\"mr-2\"\n              :error-messages=\"errors\"\n              @keydown.space.prevent\n            >\n              <template v-if=\"errors.length\" #append><u-errors-tooltip :errors=\"errors\" /></template>\n            </u-text-field>\n          </ValidationProvider>\n        </v-col>\n        <v-col cols=\"3\">\n          <ValidationProvider v-slot=\"{ errors }\" rules=\"min_value:1|max_value:128\">\n            <u-text-field\n              v-model=\"alias.v6Prefix\"\n              :label=\"$t('prefix')\"\n              placeholder=\"1-128\"\n              type=\"number\"\n              :error-messages=\"errors\"\n            >\n              <template v-if=\"errors.length\" #append><u-errors-tooltip :errors=\"errors\" /></template>\n            </u-text-field>\n          </ValidationProvider>\n        </v-col>\n        <v-col class=\"shrink\">\n          <u-btn icon :small=\"false\" :min-width=\"null\" class=\"primary mx-4\" @click=\"passes(onAddAlias)\">\n            <v-icon color=\"white\">mdi-check</v-icon>\n          </u-btn>\n        </v-col>\n        <v-col class=\"shrink\">\n          <u-btn icon :small=\"false\" :min-width=\"null\" @click=\"adding = false\"><v-icon>mdi-close</v-icon></u-btn>\n        </v-col>\n      </v-row>\n    </ValidationObserver>\n  </div>\n</template>\n<script>\n  import cloneDeep from 'lodash/cloneDeep'\n  import { extend } from 'vee-validate'\n  import defaults from '../../defaults'\n\n  export default {\n    inject: ['$intf', '$interfaces'],\n\n    props: {\n      /**\n       * the key under `interface` settings.json where aliases are going to be set\n       * e.g.\n       * `v6Aliases` for IPv6 settings\n       * */\n      aliasKey: { type: String, default: 'v6Aliases' },\n    },\n\n    data({ $intf }) {\n      const intf = $intf()\n      return {\n        adding: false, // boolean telling to show the add fields\n        alias: { ...defaults.v6_alias }, // model for new v6 alias\n        list: intf.v6Aliases?.length ? cloneDeep(intf.v6Aliases) : [],\n      }\n    },\n    computed: {\n      intf: ({ $intf }) => $intf(),\n      interfaces: ({ $interfaces }) => $interfaces(),\n    },\n    watch: {\n      adding(value) {\n        if (!value) {\n          // reset\n          this.alias = { ...defaults.v6_alias }\n        }\n      },\n      list: {\n        deep: true,\n        handler(newList) {\n          this.$set(this.intf, this.aliasKey, newList)\n        },\n      },\n    },\n    created() {\n      extend('unique_ip_v6_address', this.validateUniqueIpV6Address)\n    },\n    methods: {\n      /**\n       * Make sure the IPv6 address of the alias being added does not conflict with any other\n       * interfaces.\n       *\n       * @param {string} value\n       *\n       * @returns {string|boolean}\n       */\n      validateUniqueIpV6Address(value) {\n        // check aliases from other network interfaces\n        for (const networkInterface of this.interfaces) {\n          // ignore current interface, those will be checked from the current editable data\n          if (networkInterface.interfaceId === this.intf.interfaceId) {\n            continue\n          }\n\n          // check v6 aliases\n          if (networkInterface.v6Aliases?.length) {\n            for (const v6Alias of networkInterface.v6Aliases) {\n              if (v6Alias.v6Address === value) {\n                return this.$t('address_conflicts_with_interface', [networkInterface.name])\n              }\n            }\n          }\n\n          // check v6 static address\n          if (networkInterface.v6StaticAddress === value) {\n            return this.$t('address_conflicts_with_interface', [networkInterface.name])\n          }\n        }\n\n        // check v6 addresses that are currently being added/edited on this interface\n        for (const v6Alias of this.list) {\n          if (v6Alias.v6Address === value) {\n            return this.$t('address_conflicts_with_current_interface')\n          }\n        }\n        if (this.intf.v6StaticAddress === value) {\n          return this.$t('address_conflicts_with_current_interface')\n        }\n\n        return true\n      },\n      onAddAlias() {\n        this.list.push(this.alias)\n        this.adding = false\n      },\n      onRemoveAlias(index) {\n        this.list.splice(index, 1)\n      },\n    },\n  }\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}