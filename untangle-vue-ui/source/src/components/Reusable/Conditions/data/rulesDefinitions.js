/**
 * sets the conditions and actions which are available/used for each rule type
 */
export const ruleDefs = {
  'port-forward-rules': {
    name: 'port_forward_rules',
    chains: 'firewall.tables.port-forward.chains',
    conditions: [
      // 'DESTINATION_ADDRESS',
      // 'DESTINATION_ADDRESS_V6',
      'DST_PORT',
      // 'SOURCE_ADDRESS',
      // 'SOURCE_ADDRESS_V6',
      // 'SOURCE_ADDRESS_TYPE',
      // 'SOURCE_INTERFACE_NAME',
      // 'SOURCE_INTERFACE_TYPE',
      // 'SOURCE_INTERFACE_ZONE',
      // 'SOURCE_PORT',
      'DST_LOCAL',
      'PROTOCOL',
    ],
    actions: ['DNAT'],
    default: {
      action: { type: 'DNAT', dnat_address: '' },
      conditions: [
        { type: 'DST_LOCAL', op: '==', value: true },
        { type: 'DST_PORT', op: '==', value: '' },
        { type: 'PROTOCOL', op: '==', value: '6' },
      ],
      description: '',
      enabled: true,
      ruleId: null,
    },
  },
  'prioritization-rules': {
    name: 'prioritization_rules',
    chains: 'firewall.tables.shaping.chains',
    conditions: [
      'SOURCE_ADDRESS',
      'SOURCE_ADDRESS_V6',
      'SOURCE_INTERFACE_TYPE',
      'SOURCE_INTERFACE_ZONE',
      'SOURCE_PORT',
      'DESTINATION_ADDRESS',
      'DESTINATION_ADDRESS_V6',
      'DESTINATION_INTERFACE_TYPE',
      'DESTINATION_INTERFACE_ZONE',
      'DESTINATION_PORT',
      'IP_PROTOCOL',
      'SERVER_DNS_HINT',
    ],
    actions: ['SET_PRIORITY'],
    default: {
      action: { type: 'SET_PRIORITY', priority: 20 }, // 20 = standard priority
      conditions: [],
      enabled: true,
    },
  },
  'limiting-rules': {
    name: 'limiting_rules',
    chains: 'firewall.tables.shaping.chains',
    conditions: [
      'SOURCE_ADDRESS',
      'SOURCE_ADDRESS_V6',
      'SOURCE_INTERFACE_TYPE',
      'SOURCE_INTERFACE_ZONE',
      'SOURCE_PORT',
      'DESTINATION_ADDRESS',
      'DESTINATION_ADDRESS_V6',
      'DESTINATION_INTERFACE_TYPE',
      'DESTINATION_INTERFACE_ZONE',
      'DESTINATION_PORT',
      'IP_PROTOCOL',
      'LIMIT_RATE',
      'BURST_SIZE',
      'SERVER_DNS_HINT',
    ],
    actions: [], // computed based on operator for LESS => SET_PRIORITY, for GREATER => LIMIT_EXCEED_ACTION
    default: {
      action: { type: 'SET_PRIORITY', priority: 20 },
      conditions: [
        {
          type: 'LIMIT_RATE',
          op: '<',
          value: '',
          rate_unit: 'PACKETS_PER_SECOND',
        },
      ],
      enabled: true,
    },
  },
  'nat-rules': {
    name: 'nat_rules',
    chains: 'firewall.tables.nat.chains',
    conditions: [
      'APPLICATION_CATEGORY',
      'APPLICATION_CATEGORY_INFERRED',
      'APPLICATION_NAME',
      'APPLICATION_NAME_INFERRED',
      'APPLICATION_PRODUCTIVITY',
      'APPLICATION_PRODUCTIVITY_INFERRED',
      'APPLICATION_RISK',
      'APPLICATION_RISK_INFERRED',
      'DESTINATION_ADDRESS',
      'DESTINATION_ADDRESS_V6',
      'DESTINATION_ADDRESS_TYPE',
      'DESTINATION_INTERFACE_NAME',
      'DESTINATION_INTERFACE_TYPE',
      'DESTINATION_INTERFACE_ZONE',
      'DESTINATION_PORT',
      'SOURCE_ADDRESS',
      'SOURCE_ADDRESS_TYPE',
      'SOURCE_INTERFACE_NAME',
      'SOURCE_INTERFACE_TYPE',
      'SOURCE_INTERFACE_ZONE',
      'SOURCE_PORT',
      'IP_PROTOCOL',
    ],
    actions: ['SNAT', 'MASQUERADE'],
    default: {
      action: { type: 'SNAT', snat_address: '' },
      conditions: [],
      description: '',
      enabled: true,
      ruleId: null,
    },
  },
  'user-wan-rules': {
    name: 'local_defined_rules',
    chains: 'wan.policy_chains',
    conditions: [
      'APPLICATION_CATEGORY_INFERRED',
      'APPLICATION_NAME_INFERRED',
      'APPLICATION_PRODUCTIVITY_INFERRED',
      'APPLICATION_RISK_INFERRED',
      'DESTINATION_ADDRESS',
      'DESTINATION_ADDRESS_V6',
      'DESTINATION_ADDRESS_TYPE',
      'DESTINATION_PORT',
      'SOURCE_ADDRESS',
      'SOURCE_ADDRESS_V6',
      'SOURCE_ADDRESS_TYPE',
      'SOURCE_INTERFACE_NAME',
      'SOURCE_INTERFACE_TYPE',
      'SOURCE_INTERFACE_ZONE',
      'SOURCE_PORT',
      'IP_PROTOCOL',
      'GEOIP',
      'SERVER_DNS_HINT',
    ],
    actions: ['WAN_POLICY'],
    default: {
      action: { type: 'WAN_POLICY' },
      conditions: [],
      enabled: true,
    },
  },
  'command-center-rules': {
    name: 'etm_defined_rules',
    chains: 'wan.policy_chains',
    disabled: true,
    conditions: [
      'APPLICATION_CATEGORY', // inferred
      'APPLICATION_NAME', // inferred
      'APPLICATION_PRODUCTIVITY', // inferred
      'APPLICATION_RISK', // inferred
      'DESTINATION_ADDRESS',
      'DESTINATION_ADDRESS_V6',
      'DESTINATION_ADDRESS_TYPE',
      'DESTINATION_PORT',
      'SOURCE_ADDRESS',
      'SOURCE_ADDRESS_V6',
      'SOURCE_ADDRESS_TYPE',
      'SOURCE_INTERFACE_NAME',
      'SOURCE_INTERFACE_TYPE',
      'SOURCE_INTERFACE_ZONE',
      'SOURCE_PORT',
      'IP_PROTOCOL',
      'GEOIP',
      'SERVER_DNS_HINT',
    ],
    actions: ['WAN_POLICY'],
    default: {
      action: { type: 'WAN_POLICY' },
      conditions: [],
      enabled: true,
    },
  },

  'filter-rules': {
    name: 'filter_rules',
    chains: 'firewall.tables.filter.chains',
    conditions: [
      'APPLICATION_CATEGORY',
      'APPLICATION_NAME',
      'APPLICATION_PRODUCTIVITY',
      'APPLICATION_RISK',
      'DESTINATION_ADDRESS',
      'DESTINATION_ADDRESS_V6',
      'DESTINATION_INTERFACE_TYPE',
      'DESTINATION_INTERFACE_ZONE',
      'DESTINATION_PORT',
      'SOURCE_ADDRESS',
      'SOURCE_ADDRESS_V6',
      'SOURCE_INTERFACE_TYPE',
      'SOURCE_INTERFACE_ZONE',
      'SOURCE_PORT',
      'CT_STATE',
      'IP_PROTOCOL',
      'SERVER_DNS_HINT',
    ],
    actions: ['ACCEPT', 'REJECT', 'DROP'],
    default: {
      action: { type: 'DROP' },
      conditions: [],
      enabled: true,
      log: false,
    },
  },
  'access-rules': {
    name: 'access_rules',
    chains: 'firewall.tables.access.chains',
    conditions: [
      'DESTINATION_ADDRESS',
      'DESTINATION_ADDRESS_V6',
      'DESTINATION_PORT',
      'SOURCE_ADDRESS',
      'SOURCE_ADDRESS_V6',
      'SOURCE_ADDRESS_TYPE',
      'SOURCE_INTERFACE_NAME',
      'SOURCE_INTERFACE_TYPE',
      'SOURCE_INTERFACE_ZONE',
      'SOURCE_PORT',
      'CT_STATE',
      'DESTINED_LOCAL',
      'IP_PROTOCOL',
    ],
    actions: ['ACCEPT', 'REJECT', 'DROP'],
    default: {
      action: { type: 'ACCEPT' },
      conditions: [],
      enabled: true,
      log: false,
    },
  },

  'bypass-rules': {
    name: 'bypass_rules',
    path: 'bypass',
    conditions: [
      'DESTINATION_ADDRESS',
      'DESTINATION_ADDRESS_V6',
      'DESTINATION_PORT',
      'SOURCE_ADDRESS',
      'SOURCE_ADDRESS_V6',
      'SOURCE_INTERFACE_NAME',
      'SOURCE_INTERFACE_TYPE',
      'SOURCE_INTERFACE_ZONE',
      'SOURCE_PORT',
      'IP_PROTOCOL',
      'MAC_ADDRESS',
    ],
    default: {
      action: { type: 'BYPASS' },
      conditions: [],
      enabled: true,
      log: false,
      ruleId: null,
    },
    actions: ['BYPASS'],
  },
}
