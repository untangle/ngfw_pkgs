<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Class: Net::SSH::Transport::Session</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <link rel="stylesheet" href="../../../.././rdoc-style.css" type="text/css" media="screen" />

    <script language="JavaScript" type="text/javascript">
    // <![CDATA[

        function toggleSource( id )
        {
          var elem
          var link

          if( document.getElementById )
          {
            elem = document.getElementById( id )
            link = document.getElementById( "l_" + id )
          }
          else if ( document.all )
          {
            elem = eval( "document.all." + id )
            link = eval( "document.all.l_" + id )
          }
          else
            return false;

          if( elem.style.display == "block" )
          {
            elem.style.display = "none"
            link.innerHTML = "show source"
          }
          else
          {
            elem.style.display = "block"
            link.innerHTML = "hide source"
          }
        }

        function openCode( url )
        {
          window.open( url, "SOURCE_CODE", "width=400,height=400,scrollbars=yes" )
        }
      // ]]>
    </script>
  </head>

  <body>
  <table width="100%" border='0' cellpadding='0' cellspacing='0' class='banner'><tr>
  <td class="file-title"><span class="file-title-prefix">Class</span><br />Net::SSH::Transport::Session</td>
  <td align="right">
    <table cellspacing=0 cellpadding=2>
      <tr valign="top">
        <td>In:</td>
        <td>
<a href="../../../../files/lib/net/ssh/transport/session_rb.html">lib/net/ssh/transport/session.rb</a>
        </td>
      </tr>
    <tr>
      <td>Parent:</td>
      <td>
Object
     </td>
   </tr>
         </table>
        </td>
        </tr>
      </table>
 <!-- banner header -->

  <div id="bodyContent">
      <div id="content">

  <div class="description"><p>
Represents a low-level <a href="../../SSH.html">SSH</a> session, at the
transport protocol level. This handles the algorithm negotiation and key
exchange for any <a href="../../SSH.html">SSH</a> connection.
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="#M000075">client_name</a></li>
  <li><a href="#M000076">close</a></li>
  <li><a href="#M000073">new</a></li>
  <li><a href="#M000074">peer</a></li>
  <li><a href="#M000080">ping!</a></li>
  <li><a href="#M000079">reader_ready?</a></li>
  <li><a href="#M000078">send_message</a></li>
  <li><a href="#M000072">version</a></li>
  <li><a href="#M000077">wait_for_message</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="Constants.html">Constants</a></li>
</ul>



  <div class="sectiontitle">Constants</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class="attr-name">NAME</td>
    <td>=</td>
    <td class="attr-value">&quot;Ruby/Net::SSH&quot;</td>
  </tr>
  <tr valign='top'>
    <td>&nbsp;</td>
    <td colspan="2" class="attr-desc">
The name that <a href="../../SSH.html">Net::SSH</a> reports for itself

</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">PROTOCOL</td>
    <td>=</td>
    <td class="attr-value">&quot;SSH-2.0&quot;</td>
  </tr>
  <tr valign='top'>
    <td>&nbsp;</td>
    <td colspan="2" class="attr-desc">
The <a href="../../SSH.html">SSH</a> protocol supported by <a
href="../../SSH.html">Net::SSH</a>.

</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">VALID_OPTIONS</td>
    <td>=</td>
    <td class="attr-value">[ :port, :host_key, :kex, :encryption, :hmac,                           :compression, :languages, :compression_level, :proxy,                           :timeout ]</td>
  </tr>
  </table>

  <div class="sectiontitle">Attributes</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class='attr-rw'>
[W]
    </td>
    <td class='attr-name'>algorithm_negotiator</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>algorithms</td>
    <td class='attr-desc'>
the collection of algorithms currently being used

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[W]
    </td>
    <td class='attr-name'>ciphers</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[W]
    </td>
    <td class='attr-name'>compressors</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[W]
    </td>
    <td class='attr-name'>decompressors</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[W]
    </td>
    <td class='attr-name'>default_port</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[W]
    </td>
    <td class='attr-name'>hmacs</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[W]
    </td>
    <td class='attr-name'>kexs</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[W]
    </td>
    <td class='attr-name'>logger</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[W]
    </td>
    <td class='attr-name'>packet_receiver</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[W]
    </td>
    <td class='attr-name'>packet_sender</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>session_id</td>
    <td class='attr-desc'>
the unique session identifier

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[W]
    </td>
    <td class='attr-name'>socket_factory</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[W]
    </td>
    <td class='attr-name'>version_negotiator</td>
    <td class='attr-desc'></td>
  </tr>
  </table>

<div class="sectiontitle">Public Class methods</div>
<div class="method">
  <div class="title">
    <a name="M000073"></a><b>new</b>( host, options={} ) {|self| ...}
  </div>
  <div class="description">
  <p>
Create a <a href="Session.html#M000073">new</a> connection to the given
host. This will negotiate the algorithms to use and exchange the keys. A
block must be given. The uninitialized <tt>self</tt> will be passed to the
block, so that dependencies may be injected.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000073_source')" id="l_M000073_source">show source</a> ]</p>
  <div id="M000073_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/transport/session.rb, line 71</span>
 71:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>( <span class="ruby-identifier">host</span>, <span class="ruby-identifier">options</span>={} )
 72:           <span class="ruby-ivar">@saved_message</span> = <span class="ruby-keyword kw">nil</span>
 73:           <span class="ruby-ivar">@session_id</span> = <span class="ruby-keyword kw">nil</span>
 74:           <span class="ruby-ivar">@host</span> = <span class="ruby-identifier">host</span>
 75: 
 76:           <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">self</span>
 77: 
 78:           <span class="ruby-identifier">invalid_options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">keys</span> <span class="ruby-operator">-</span> <span class="ruby-constant">VALID_OPTIONS</span>
 79: 
 80:           <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">invalid_options</span>.<span class="ruby-identifier">empty?</span>
 81:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
 82:               <span class="ruby-node">&quot;invalid option(s) to #{self.class}: #{invalid_options.inspect}&quot;</span>
 83:           <span class="ruby-keyword kw">end</span>
 84: 
 85:           <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-value str">&quot;connecting&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug?</span>
 86: 
 87:           <span class="ruby-ivar">@port</span> = <span class="ruby-identifier">options</span>[ <span class="ruby-identifier">:port</span> ] <span class="ruby-operator">||</span> <span class="ruby-ivar">@default_port</span>
 88:           <span class="ruby-ivar">@socket</span> = <span class="ruby-identifier">timeout</span>( <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:timeout</span>] <span class="ruby-operator">||</span> <span class="ruby-value">0</span> ) <span class="ruby-keyword kw">do</span>
 89:             ( <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:proxy</span>] <span class="ruby-operator">||</span> <span class="ruby-ivar">@socket_factory</span> ).<span class="ruby-identifier">open</span>( <span class="ruby-identifier">host</span>, <span class="ruby-ivar">@port</span> )
 90:           <span class="ruby-keyword kw">end</span>
 91: 
 92:           <span class="ruby-ivar">@packet_sender</span>.<span class="ruby-identifier">socket</span> = <span class="ruby-ivar">@socket</span>
 93:           <span class="ruby-ivar">@packet_receiver</span>.<span class="ruby-identifier">socket</span> = <span class="ruby-ivar">@socket</span>
 94: 
 95:           <span class="ruby-ivar">@kex_info</span> = {
 96:             <span class="ruby-identifier">:client_version_string</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">version</span>,
 97:             <span class="ruby-identifier">:server_version_string</span> =<span class="ruby-operator">&gt;</span>
 98:               <span class="ruby-ivar">@version_negotiator</span>.<span class="ruby-identifier">negotiate</span>( <span class="ruby-ivar">@socket</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">version</span> ) }
 99: 
100:           <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
101:           <span class="ruby-identifier">kexinit</span>
102:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000072"></a><b>version</b>()
  </div>
  <div class="description">
  <p>
Returns the <a href="Session.html#M000072">version</a> string of this
client.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000072_source')" id="l_M000072_source">show source</a> ]</p>
  <div id="M000072_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/net/ssh/transport/session.rb, line 59</span>
59:         <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">version</span>
60:           <span class="ruby-node">&quot;#{PROTOCOL}-#{NAME}_#{Net::SSH::Version::STRING}&quot;</span>
61:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div class="method">
  <div class="title">
    <a name="M000075"></a><b>client_name</b>()
  </div>
  <div class="description">
  <p>
Returns the name of the client&#8216;s host, as reported by the socket.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000075_source')" id="l_M000075_source">show source</a> ]</p>
  <div id="M000075_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/transport/session.rb, line 114</span>
114:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">client_name</span>
115:           <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@hostname</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">defined?</span> <span class="ruby-ivar">@hostname</span>
116: 
117:           <span class="ruby-identifier">sockaddr</span> = <span class="ruby-ivar">@socket</span>.<span class="ruby-identifier">getsockname</span>
118:           <span class="ruby-keyword kw">begin</span>
119:             <span class="ruby-ivar">@hostname</span> =
120:               <span class="ruby-constant">Socket</span>.<span class="ruby-identifier">getnameinfo</span>( <span class="ruby-identifier">sockaddr</span>, <span class="ruby-constant">Socket</span><span class="ruby-operator">::</span><span class="ruby-constant">NI_NAMEREQD</span> ).<span class="ruby-identifier">first</span>
121:           <span class="ruby-keyword kw">rescue</span>
122:             <span class="ruby-keyword kw">begin</span>
123:               <span class="ruby-ivar">@hostname</span> = <span class="ruby-constant">Socket</span>.<span class="ruby-identifier">getnameinfo</span>( <span class="ruby-identifier">sockaddr</span> ).<span class="ruby-identifier">first</span>
124:             <span class="ruby-keyword kw">rescue</span>
125:               <span class="ruby-keyword kw">begin</span>
126:                 <span class="ruby-ivar">@hostname</span> = <span class="ruby-constant">Socket</span>.<span class="ruby-identifier">gethostbyname</span>( <span class="ruby-constant">Socket</span>.<span class="ruby-identifier">gethostname</span> ).<span class="ruby-identifier">first</span>
127:               <span class="ruby-keyword kw">rescue</span>
128:                 <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">error</span> <span class="ruby-value str">&quot;the client ipaddr/name could not be determined&quot;</span>
129:               <span class="ruby-keyword kw">end</span>
130:             <span class="ruby-keyword kw">end</span>
131:           <span class="ruby-keyword kw">end</span>
132: 
133:           <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@hostname</span>
134:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000076"></a><b>close</b>()
  </div>
  <div class="description">
  <p>
Closes the connection.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000076_source')" id="l_M000076_source">show source</a> ]</p>
  <div id="M000076_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/transport/session.rb, line 149</span>
149:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">close</span>
150:           <span class="ruby-comment cmt"># TODO: send a DISCONNECT message to the server to close gracefully</span>
151:           <span class="ruby-ivar">@socket</span>.<span class="ruby-identifier">close</span>
152:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000074"></a><b>peer</b>()
  </div>
  <div class="description">
  <p>
Returns info about the remote <a href="Session.html#M000074">peer</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000074_source')" id="l_M000074_source">show source</a> ]</p>
  <div id="M000074_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/transport/session.rb, line 105</span>
105:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">peer</span>
106:           <span class="ruby-ivar">@peer</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">begin</span>
107:             <span class="ruby-identifier">addr</span> = <span class="ruby-ivar">@socket</span>.<span class="ruby-identifier">getpeername</span>
108:             <span class="ruby-identifier">ip_address</span> = <span class="ruby-constant">Socket</span>.<span class="ruby-identifier">getnameinfo</span>(<span class="ruby-identifier">addr</span>, <span class="ruby-constant">Socket</span><span class="ruby-operator">::</span><span class="ruby-constant">NI_NUMERICHOST</span> <span class="ruby-operator">|</span> <span class="ruby-constant">Socket</span><span class="ruby-operator">::</span><span class="ruby-constant">NI_NUMERICSERV</span>).<span class="ruby-identifier">first</span>
109:             { <span class="ruby-identifier">:ip</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ip_address</span>, <span class="ruby-identifier">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@port</span>.<span class="ruby-identifier">to_i</span>, <span class="ruby-identifier">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@host</span> }
110:           <span class="ruby-keyword kw">end</span>
111:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000080"></a><b>ping!</b>()
  </div>
  <div class="description">
  <p>
Sends an IGNORE packet to the server, as a way to ping the connection and
make sure the server knows the client is still active.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000080_source')" id="l_M000080_source">show source</a> ]</p>
  <div id="M000080_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/transport/session.rb, line 327</span>
327:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ping!</span>
328:           <span class="ruby-identifier">send_message</span> [<span class="ruby-constant">IGNORE</span>, <span class="ruby-value">4</span>, <span class="ruby-value str">&quot;ping&quot;</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;cNA4&quot;</span>)
329:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000079"></a><b>reader_ready?</b>()
  </div>
  <div class="description">
  <p>
Returns true if there are bytes to be read on the socket. Note that this
only means there is an encrypted packet ready to be read, not that there is
data available to any particular <a href="../../SSH.html">SSH</a> channel.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000079_source')" id="l_M000079_source">show source</a> ]</p>
  <div id="M000079_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/transport/session.rb, line 321</span>
321:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reader_ready?</span>
322:           <span class="ruby-constant">IO</span>.<span class="ruby-identifier">select</span>([<span class="ruby-ivar">@socket</span>],<span class="ruby-keyword kw">nil</span>,<span class="ruby-keyword kw">nil</span>,<span class="ruby-value">0</span>) <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
323:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000078"></a><b>send_message</b>( message )
  </div>
  <div class="description">
  <p>
Sends the given payload, using the currently configured <a
href="OutgoingPacketStream.html">OutgoingPacketStream</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000078_source')" id="l_M000078_source">show source</a> ]</p>
  <div id="M000078_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/transport/session.rb, line 310</span>
310:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">send_message</span>( <span class="ruby-identifier">message</span> )
311:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug?</span>
312:             <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;sending message &gt;&gt;#{message.to_s.inspect}&lt;&lt;&quot;</span>
313:           <span class="ruby-keyword kw">end</span>
314: 
315:           <span class="ruby-ivar">@packet_sender</span>.<span class="ruby-identifier">send</span> <span class="ruby-identifier">message</span>
316:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000077"></a><b>wait_for_message</b>()
  </div>
  <div class="description">
  <p>
Waits for the next message from the server, handling common requests like
DISCONNECT, IGNORE, DEBUG, and KEXINIT in the background. The next message
is returned as a [ type, buffer ] tuple, where the buffer is a <a
href="../Util/ReaderBuffer.html">Net::SSH::Util::ReaderBuffer</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000077_source')" id="l_M000077_source">show source</a> ]</p>
  <div id="M000077_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/transport/session.rb, line 244</span>
244:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">wait_for_message</span>
245:           <span class="ruby-identifier">buffer</span> = <span class="ruby-identifier">type</span> = <span class="ruby-keyword kw">nil</span>
246: 
247:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@saved_message</span>
248:             <span class="ruby-identifier">type</span>, <span class="ruby-identifier">buffer</span> = <span class="ruby-ivar">@saved_message</span>
249:             <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;returning saved message: #{type}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug?</span>
250:             <span class="ruby-ivar">@saved_message</span> = <span class="ruby-keyword kw">nil</span>
251:           <span class="ruby-keyword kw">else</span>
252:             <span class="ruby-identifier">loop</span> <span class="ruby-keyword kw">do</span>
253:               <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug?</span>
254:                 <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-value str">&quot;waiting for packet from server...&quot;</span>
255:               <span class="ruby-keyword kw">end</span>
256: 
257:               <span class="ruby-identifier">buffer</span> = <span class="ruby-ivar">@packet_receiver</span>.<span class="ruby-identifier">get</span>
258:               <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">buffer</span>
259: 
260:               <span class="ruby-identifier">type</span> = <span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">read_byte</span>
261:               <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;got packet of type #{type}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug?</span>
262: 
263:               <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">type</span>
264:                 <span class="ruby-keyword kw">when</span> <span class="ruby-constant">DISCONNECT</span>
265:                   <span class="ruby-identifier">reason_code</span> = <span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">read_long</span>
266:                   <span class="ruby-identifier">description</span> = <span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">read_string</span>
267:                   <span class="ruby-identifier">language</span> = <span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">read_string</span>
268:                   <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Transport</span><span class="ruby-operator">::</span><span class="ruby-constant">Disconnect</span>,
269:                     <span class="ruby-node">&quot;disconnected: #{description} (#{reason_code})&quot;</span>
270: 
271:                 <span class="ruby-keyword kw">when</span> <span class="ruby-constant">IGNORE</span>
272:                   <span class="ruby-comment cmt"># do nothing</span>
273:                   <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">info</span> <span class="ruby-value str">&quot;received IGNORE message &quot;</span> <span class="ruby-operator">+</span>
274:                     <span class="ruby-node">&quot;(#{buffer.read_string.inspect})&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug?</span>
275: 
276:                 <span class="ruby-keyword kw">when</span> <span class="ruby-constant">DEBUG</span>
277:                   <span class="ruby-comment cmt"># do nothing</span>
278:                   <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">info</span> <span class="ruby-value str">&quot;received DEBUG message&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug?</span>
279:                   <span class="ruby-identifier">always_display</span> = <span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">read_bool</span>
280:                   <span class="ruby-identifier">message</span> = <span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">read_string</span>
281:                   <span class="ruby-identifier">language</span> = <span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">read_string</span>
282:                   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">always_display</span>
283:                     <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;#{message} (#{language})&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">warn?</span>
284:                   <span class="ruby-keyword kw">else</span>
285:                     <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;#{message} (#{language})&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug?</span>
286:                   <span class="ruby-keyword kw">end</span>
287: 
288:                 <span class="ruby-keyword kw">when</span> <span class="ruby-constant">KEXINIT</span>
289:                   <span class="ruby-comment cmt"># unless we're already doing a key-exchange, do key</span>
290:                   <span class="ruby-comment cmt"># re-exchange</span>
291:                   <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@doing_kexinit</span>
292:                     <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">info</span> <span class="ruby-value str">&quot;re-key requested&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">info?</span>
293:                     <span class="ruby-ivar">@saved_message</span> = [ <span class="ruby-identifier">type</span>, <span class="ruby-identifier">buffer</span> ]
294:                     <span class="ruby-identifier">kexinit</span>
295:                   <span class="ruby-keyword kw">else</span>
296:                     <span class="ruby-keyword kw">break</span>
297:                   <span class="ruby-keyword kw">end</span>
298: 
299:                 <span class="ruby-keyword kw">else</span>
300:                   <span class="ruby-keyword kw">break</span>
301:               <span class="ruby-keyword kw">end</span>
302:             <span class="ruby-keyword kw">end</span>
303:           <span class="ruby-keyword kw">end</span>
304: 
305:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">type</span>, <span class="ruby-identifier">buffer</span>
306:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>

    </body>
</html>